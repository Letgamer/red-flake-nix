{ inputs, config, lib, pkgs, modulesPath, ... }:

let
  # use old version of metasploit due to issues; use: https://lazamar.co.uk/nix-versions/
  # get sha256 from rev using: nix-prefetch-git https://github.com/NixOS/nixpkgs/ 05bbf675397d5366259409139039af8077d695ce
  revpkgs = import (builtins.fetchTarball {
    url = "https://github.com/NixOS/nixpkgs/archive/05bbf675397d5366259409139039af8077d695ce.tar.gz";
    sha256 = "1r26vjqmzgphfnby5lkfihz6i3y70hq84bpkwd43qjjvgxkcyki0";
  }) {
    system = "x86_64-linux"; # Set your system explicitly
  };

  metasploit-6_4_16 = revpkgs.metasploit;
in
{
  environment.systemPackages = with pkgs; [
    exploitdb
    metasploit-6_4_16
    cvemap
  ];
}
